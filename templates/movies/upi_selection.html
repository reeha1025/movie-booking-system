{% extends "users/basic.html" %}
{% block content %}
<style>
  * { box-sizing: border-box; }
  body { background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); min-height: 100vh; margin: 0; padding: 0; }
  .payment-container { max-width: 500px; margin: 20px auto; padding: 15px; width: 100%; }
  .card { background: #1f2937; border: 1px solid #374151; border-radius: 16px; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5); overflow: hidden; }
  .card-header { background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%); border-radius: 16px 16px 0 0; padding: 20px; text-align: center; }
  .card-header h3 { color: #fff; margin: 0; font-weight: 700; font-size: clamp(20px, 5vw, 28px); }
  .card-body { padding: clamp(15px, 4vw, 32px); }
  .amount-display { background: #111827; border-radius: 12px; padding: 15px; text-align: center; margin-bottom: 24px; }
  .amount-label { color: #9ca3af; font-size: clamp(12px, 3vw, 14px); margin-bottom: 8px; }
  .amount-value { color: #dc3545; font-size: clamp(28px, 8vw, 36px); font-weight: 700; }
  .upi-options { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin: 24px 0; }
  .upi-option { display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 12px; background: #111827; border: 2px solid #374151; border-radius: 12px; cursor: pointer; transition: all 0.3s; touch-action: manipulation; aspect-ratio: 1; }
  .upi-option:hover { border-color: #6366f1; transform: scale(1.05); }
  .upi-option.selected { border-color: #dc3545; background: rgba(16, 185, 129, 0.2); }
  .upi-icon { width: 40px; height: 40px; object-fit: contain; }
  .upi-label { color: #f3f4f6; font-weight: 600; font-size: 11px; margin-top: 6px; text-align: center; }
  .btn-pay { width: 100%; padding: 16px; background: linear-gradient(135deg, #dc3545 0%, #bb2d3b 100%); border: none; border-radius: 12px; color: #fff; font-size: clamp(16px, 4vw, 18px); font-weight: 700; cursor: pointer; transition: all 0.3s; margin-top: 20px; min-height: 50px; touch-action: manipulation; }
  .btn-pay:hover { transform: translateY(-2px); box-shadow: 0 10px 20px rgba(16, 185, 129, 0.3); }
  .btn-pay:disabled { background: #4b5563; cursor: not-allowed; transform: none; }
  .secure-badge { display: flex; align-items: center; justify-content: center; margin-top: 20px; color: #9ca3af; font-size: clamp(10px, 2.5vw, 12px); flex-wrap: wrap; gap: 4px; }
  .secure-badge svg { margin-right: 6px; flex-shrink: 0; }
  .booking-info { background: #111827; border-radius: 12px; padding: 16px; margin-bottom: 24px; }
  .booking-info-item { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #374151; gap: 10px; flex-wrap: wrap; }
  .booking-info-item:last-child { border-bottom: none; }
  .booking-info-label { color: #9ca3af; font-size: clamp(11px, 3vw, 12px); }
  .booking-info-value { color: #f3f4f6; font-weight: 600; font-size: clamp(12px, 3vw, 14px); text-align: right; }
  @media (max-width: 480px) {
    .payment-container { margin: 10px auto; padding: 10px; }
    .card-body { padding: 15px; }
    .upi-options { grid-template-columns: repeat(2, 1fr); gap: 10px; }
    .upi-option { min-height: 80px; }
  }
</style>

<div class="payment-container">
  <div class="card">
    <div class="card-header">
      <h3>Select Payment Method</h3>
    </div>
    <div class="card-body">
      <div class="booking-info">
        <div class="booking-info-item">
          <span class="booking-info-label">Movie</span>
          <span class="booking-info-value">{{ booking.movie.name }}</span>
        </div>
        <div class="booking-info-item">
          <span class="booking-info-label">Theater</span>
          <span class="booking-info-value">{{ booking.theater.name }}</span>
        </div>
        <div class="booking-info-item">
          <span class="booking-info-label">Seat</span>
          <span class="booking-info-value">{{ booking.seat.seat_number }}</span>
        </div>
        <div class="booking-info-item">
          <span class="booking-info-label">Show Time</span>
          <span class="booking-info-value">{{ booking.theater.time|date:"M d, Y h:i A" }}</span>
        </div>
      </div>

      <div class="amount-display">
        <div class="amount-label">Total Amount</div>
        <div class="amount-value">₹{{ amount }}</div>
      </div>

      <form method="post" id="upiForm">
        {% csrf_token %}
        <div class="upi-options">
          <div class="upi-option" onclick="selectUPI('gpay')">
            <input type="radio" name="upi_app" value="gpay" id="gpay" style="display:none;">
            <svg class="upi-icon" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg">
              <circle cx="32" cy="32" r="32" fill="#4285F4"/>
              <text x="32" y="36" text-anchor="middle" font-size="24" font-weight="bold" fill="white">G</text>
            </svg>
            <div class="upi-label">Google Pay</div>
          </div>

          <div class="upi-option" onclick="selectUPI('phonepe')">
            <input type="radio" name="upi_app" value="phonepe" id="phonepe" style="display:none;">
            <svg class="upi-icon" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg">
              <rect width="64" height="64" fill="#5F4B8B"/>
              <text x="32" y="36" text-anchor="middle" font-size="20" font-weight="bold" fill="white">PP</text>
            </svg>
            <div class="upi-label">PhonePe</div>
          </div>

          <div class="upi-option" onclick="selectUPI('paytm')">
            <input type="radio" name="upi_app" value="paytm" id="paytm" style="display:none;">
            <img src="https://paytm.com/images/Logo-Positive.svg" class="upi-icon" alt="Paytm">
            <div class="upi-label">Paytm</div>
          </div>

          <div class="upi-option" onclick="selectUPI('bhim')">
            <input type="radio" name="upi_app" value="bhim" id="bhim" style="display:none;">
            <img src="https://web-static.apna.co/images/bhim-upi-logo.png" class="upi-icon" alt="BHIM UPI">
            <div class="upi-label">BHIM</div>
          </div>
        </div>

        <button type="submit" class="btn-pay" id="payBtn" disabled>
          Continue to Pay ₹{{ amount }}
        </button>
      </form>

      <div class="secure-badge">
        <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
          <path d="M8 1a2 2 0 0 1 2 2v4H6V3a2 2 0 0 1 2-2zm3 6V3a3 3 0 0 0-6 0v4a2 2 0 0 0-2 2v5a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2z"/>
        </svg>
        100% Secure Payment | Powered by UPI
      </div>
    </div>
  </div>
</div>

<script>
function selectUPI(app) {
  document.querySelectorAll('.upi-option').forEach(el => el.classList.remove('selected'));
  document.getElementById(app).checked = true;
  document.getElementById(app).parentElement.classList.add('selected');
  document.getElementById('payBtn').disabled = false;
}
</script>
{% endblock %}
